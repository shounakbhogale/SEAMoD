2.2.0
Expression file loaded.  (30, 4)
Labels created.  (30, 3)
Mask data loaded.  (30, 16) 0.017
Sequences loaded.  (30, 2, 16, 1001) 0.017
Partitions loaded.  [(20,), (5,), (5,)]
Accessibility data loaded.  (30, 4, 4) 0.017
Partitioned Features and Labels created.  (20, 2, 16, 1001) (20, 4, 4) (20, 3) (5, 2, 16, 1001) (5, 4, 4) (5, 3) (5, 2, 16, 1001) (5, 4, 4) (5, 3)
dict_params created.
Deleted dict_data. Memory Usage: 48.0
{
    "init_seed_value": 2023,
    "dir_acc": "acc/nn4/",
    "dir_data": "data/",
    "dir_logs": "trial_sample/",
    "dir_pbms": "motifs_mod/",
    "dir_prtn": "prtn/",
    "dir_seqs": "seqs/nn4/",
    "dir_msks": "gene_msks/",
    "file_gene_exp": "gene_class.txt",
    "file_pbms": "pwms_rel.txt",
    "cells": [
        "D0_NSC",
        "D4_Neu",
        "D4_Ast",
        "D4_OligD"
    ],
    "pbm_extn": "wtmx",
    "pbm_train": "one",
    "n_seqs": 4,
    "n_cells": 4,
    "acc": "true",
    "l_seqs": 1001,
    "n_cpu": 4,
    "wt_l1": 0.0,
    "wt_l2": 0.0,
    "wt_kl": 0.0,
    "lrng_rt": 0.001,
    "conv_init": "true",
    "l_pwms": 8,
    "n_pwms": 8,
    "loss_func": "mean_squared_error",
    "shape_lyrs": [
        3,
        3
    ],
    "act_funcs": [
        "relu",
        "relu",
        "relu"
    ],
    "quant_monitor": "val_loss",
    "quant_model": "val_mean_squared_error",
    "n_epochs": 10
}
trial_sample/msk_best/ created.
mean_squared_error
Epoch 1/10
1/1 [==============================] - ETA: 0s - loss: 0.8452 - mean_squared_error: 0.84521/1 [==============================] - 3s 3s/step - loss: 0.8452 - mean_squared_error: 0.8452 - val_loss: 0.4605 - val_mean_squared_error: 0.4605
Epoch 2/10
1/1 [==============================] - ETA: 0s - loss: 0.8448 - mean_squared_error: 0.84481/1 [==============================] - 3s 3s/step - loss: 0.8448 - mean_squared_error: 0.8448 - val_loss: 0.4600 - val_mean_squared_error: 0.4600
Epoch 3/10
1/1 [==============================] - ETA: 0s - loss: 0.8443 - mean_squared_error: 0.84431/1 [==============================] - 2s 2s/step - loss: 0.8443 - mean_squared_error: 0.8443 - val_loss: 0.4594 - val_mean_squared_error: 0.4594
Epoch 4/10
1/1 [==============================] - ETA: 0s - loss: 0.8439 - mean_squared_error: 0.84391/1 [==============================] - 2s 2s/step - loss: 0.8439 - mean_squared_error: 0.8439 - val_loss: 0.4589 - val_mean_squared_error: 0.4589
Epoch 5/10
1/1 [==============================] - ETA: 0s - loss: 0.8435 - mean_squared_error: 0.84351/1 [==============================] - 2s 2s/step - loss: 0.8435 - mean_squared_error: 0.8435 - val_loss: 0.4584 - val_mean_squared_error: 0.4584
Epoch 6/10
1/1 [==============================] - ETA: 0s - loss: 0.8430 - mean_squared_error: 0.84301/1 [==============================] - 2s 2s/step - loss: 0.8430 - mean_squared_error: 0.8430 - val_loss: 0.4578 - val_mean_squared_error: 0.4578
Epoch 7/10
1/1 [==============================] - ETA: 0s - loss: 0.8426 - mean_squared_error: 0.84261/1 [==============================] - 2s 2s/step - loss: 0.8426 - mean_squared_error: 0.8426 - val_loss: 0.4573 - val_mean_squared_error: 0.4573
Epoch 8/10
1/1 [==============================] - ETA: 0s - loss: 0.8421 - mean_squared_error: 0.84211/1 [==============================] - 2s 2s/step - loss: 0.8421 - mean_squared_error: 0.8421 - val_loss: 0.4567 - val_mean_squared_error: 0.4567
Epoch 9/10
1/1 [==============================] - ETA: 0s - loss: 0.8416 - mean_squared_error: 0.84161/1 [==============================] - 2s 2s/step - loss: 0.8416 - mean_squared_error: 0.8416 - val_loss: 0.4562 - val_mean_squared_error: 0.4562
Epoch 10/10
1/1 [==============================] - ETA: 0s - loss: 0.8412 - mean_squared_error: 0.84121/1 [==============================] - 2s 2s/step - loss: 0.8412 - mean_squared_error: 0.8412 - val_loss: 0.4556 - val_mean_squared_error: 0.4556
[[ 0.00827734  0.01982128  0.01982128]
 [-0.01897368  0.01982128  0.01982128]]
<_MainProcess(MainProcess, started)> ['Random_Init', 'All', 0.8251700163838027, 0.9484107551038068, 0.7484107551038065, 0.8406638421971387, 0.5819042831628094, 0.19246437091974408, 0.5924643709197441, 0.4556110083340993, 0.9824536667320615, 0.8321069321468272, 1.0241784199014106, 0.9462463395934331, 0.439]
Deleted dict_data. Memory Usage: 46.5
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
sequence_inputs (InputLayer)    [(None, 2, 16, 1001) 0                                            
__________________________________________________________________________________________________
lambda (Lambda)                 (None, 2, 16, 1001,  0           sequence_inputs[0][0]            
__________________________________________________________________________________________________
pwms_init_lyr (Conv3D)          (None, 2, 4, 994, 8) 256         lambda[0][0]                     
__________________________________________________________________________________________________
rc_split (Lambda)               [(None, 1, 4, 994, 8 0           pwms_init_lyr[0][0]              
__________________________________________________________________________________________________
rc_neg (Lambda)                 (None, 1, 4, 994, 8) 0           rc_split[0][1]                   
__________________________________________________________________________________________________
rc_concat (Lambda)              (None, 2, 4, 994, 8) 0           rc_split[0][0]                   
                                                                 rc_neg[0][0]                     
__________________________________________________________________________________________________
maxpool_pwms (MaxPooling3D)     (None, 1, 4, 9, 8)   0           rc_concat[0][0]                  
__________________________________________________________________________________________________
permute (Permute)               (None, 4, 9, 8, 1)   0           maxpool_pwms[0][0]               
__________________________________________________________________________________________________
avg_pwms (AveragePooling3D)     (None, 4, 1, 8, 1)   0           permute[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 8)         0           avg_pwms[0][0]                   
__________________________________________________________________________________________________
transpose_2 (Permute)           (None, 8, 4)         0           lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 8, 4, 1)      0           transpose_2[0][0]                
__________________________________________________________________________________________________
combine_pwms (Conv2D)           (None, 1, 4, 4)      36          lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 4, 4)         0           combine_pwms[0][0]               
__________________________________________________________________________________________________
cell_inputs (InputLayer)        [(None, 4, 4)]       0                                            
__________________________________________________________________________________________________
mult_acc_pwms (Multiply)        (None, 4, 4)         0           lambda_3[0][0]                   
                                                                 cell_inputs[0][0]                
__________________________________________________________________________________________________
average_pooling1d (AveragePooli (None, 1, 4)         0           mult_acc_pwms[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 4)            0           average_pooling1d[0][0]          
__________________________________________________________________________________________________
cell_split (Lambda)             [(None, 1), (None, 1 0           flatten[0][0]                    
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][1]                 
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][2]                 
__________________________________________________________________________________________________
prediction_1 (Dense)            (None, 1)            3           concatenate[0][0]                
__________________________________________________________________________________________________
prediction_2 (Dense)            (None, 1)            3           concatenate_1[0][0]              
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][3]                 
__________________________________________________________________________________________________
reshape (Reshape)               (None, 1, 1)         0           prediction_1[0][0]               
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 1)         0           prediction_2[0][0]               
__________________________________________________________________________________________________
prediction_3 (Dense)            (None, 1)            3           concatenate_2[0][0]              
__________________________________________________________________________________________________
concat_cell_preds_1 (Lambda)    (None, 2, 1)         0           reshape[0][0]                    
                                                                 reshape_1[0][0]                  
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 1, 1)         0           prediction_3[0][0]               
__________________________________________________________________________________________________
concat_cell_preds_2 (Lambda)    (None, 3, 1)         0           concat_cell_preds_1[0][0]        
                                                                 reshape_2[0][0]                  
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3)            0           concat_cell_preds_2[0][0]        
==================================================================================================
Total params: 301
Trainable params: 45
Non-trainable params: 256
__________________________________________________________________________________________________
None
['Random_Init', 'All', 0.8251700163838027, 0.9484107551038068, 0.7484107551038065, 0.8406638421971387, 0.5819042831628094, 0.19246437091974408, 0.5924643709197441, 0.4556110083340993, 0.9824536667320615, 0.8321069321468272, 1.0241784199014106, 0.9462463395934331, 0.439]
