2.2.0
Expression file loaded.  (30, 4)
Labels created.  (30, 3)
Sequences loaded.  (30, 2, 16, 1001) 0.017
Partitions loaded.  [(20,), (5,), (5,)]
Accessibility data loaded.  (30, 4, 4) 0.017
Partitioned Features and Labels created.  (20, 2, 16, 1001) (20, 4, 4) (20, 3) (5, 2, 16, 1001) (5, 4, 4) (5, 3) (5, 2, 16, 1001) (5, 4, 4) (5, 3)
dict_params created.
{
    "init_seed_value": 2023,
    "dir_acc": "acc/nn/",
    "dir_data": "data/",
    "dir_logs": "trial_sample/",
    "dir_pbms": "motifs_mod/",
    "dir_prtn": "prtn/",
    "dir_seqs": "seqs/nn/",
    "file_gene_exp": "gene_class.txt",
    "file_pbms": "pwms_rel.txt",
    "cells": [
        "D0_NSC",
        "D4_Neu",
        "D4_Ast",
        "D4_OligD"
    ],
    "pbm_extn": "wtmx",
    "pbm_train": "one",
    "n_seqs": 4,
    "n_cells": 4,
    "acc": "true",
    "l_seqs": 1001,
    "n_cpu": 4,
    "wt_l1": 0.0,
    "wt_l2": 0.0,
    "wt_kl": 0.0,
    "lrng_rt": 0.001,
    "conv_init": "true",
    "l_pwms": 8,
    "n_pwms": 8,
    "loss_func": "mean_squared_error",
    "shape_lyrs": [
        3,
        3
    ],
    "act_funcs": [
        "relu",
        "relu",
        "relu"
    ],
    "quant_monitor": "val_loss",
    "quant_model": "val_mean_squared_error",
    "n_epochs": 10
}
trial_sample/training_plots created.
mean_squared_error
Epoch 1/10
1/1 [==============================] - ETA: 0s - loss: 0.8500 - mean_squared_error: 0.85001/1 [==============================] - 3s 3s/step - loss: 0.8500 - mean_squared_error: 0.8500 - val_loss: 0.4663 - val_mean_squared_error: 0.4663
Epoch 2/10
1/1 [==============================] - ETA: 0s - loss: 0.8498 - mean_squared_error: 0.84981/1 [==============================] - 2s 2s/step - loss: 0.8498 - mean_squared_error: 0.8498 - val_loss: 0.4660 - val_mean_squared_error: 0.4660
Epoch 3/10
1/1 [==============================] - ETA: 0s - loss: 0.8496 - mean_squared_error: 0.84961/1 [==============================] - 3s 3s/step - loss: 0.8496 - mean_squared_error: 0.8496 - val_loss: 0.4658 - val_mean_squared_error: 0.4658
Epoch 4/10
1/1 [==============================] - ETA: 0s - loss: 0.8494 - mean_squared_error: 0.84941/1 [==============================] - 2s 2s/step - loss: 0.8494 - mean_squared_error: 0.8494 - val_loss: 0.4656 - val_mean_squared_error: 0.4656
Epoch 5/10
1/1 [==============================] - ETA: 0s - loss: 0.8492 - mean_squared_error: 0.84921/1 [==============================] - 2s 2s/step - loss: 0.8492 - mean_squared_error: 0.8492 - val_loss: 0.4654 - val_mean_squared_error: 0.4654
Epoch 6/10
1/1 [==============================] - ETA: 0s - loss: 0.8490 - mean_squared_error: 0.84901/1 [==============================] - 3s 3s/step - loss: 0.8490 - mean_squared_error: 0.8490 - val_loss: 0.4653 - val_mean_squared_error: 0.4653
Epoch 7/10
1/1 [==============================] - ETA: 0s - loss: 0.8487 - mean_squared_error: 0.84871/1 [==============================] - 5s 5s/step - loss: 0.8487 - mean_squared_error: 0.8487 - val_loss: 0.4651 - val_mean_squared_error: 0.4651
Epoch 8/10
1/1 [==============================] - ETA: 0s - loss: 0.8485 - mean_squared_error: 0.84851/1 [==============================] - 5s 5s/step - loss: 0.8485 - mean_squared_error: 0.8485 - val_loss: 0.4649 - val_mean_squared_error: 0.4649
Epoch 9/10
1/1 [==============================] - ETA: 0s - loss: 0.8483 - mean_squared_error: 0.84831/1 [==============================] - 4s 4s/step - loss: 0.8483 - mean_squared_error: 0.8483 - val_loss: 0.4648 - val_mean_squared_error: 0.4648
Epoch 10/10
1/1 [==============================] - ETA: 0s - loss: 0.8481 - mean_squared_error: 0.84811/1 [==============================] - 2s 2s/step - loss: 0.8481 - mean_squared_error: 0.8481 - val_loss: 0.4647 - val_mean_squared_error: 0.4647
[[0.00419504 0.00992314 0.00992314]
 [0.00207528 0.00992314 0.00992314]]
<_MainProcess(MainProcess, started)> ['Random_Init', 'All', 0.8452829266191977, 0.9491061548898575, 0.7491061548898574, 0.8478317454663041, 0.6018099018895128, 0.19612921357253751, 0.5961292135725376, 0.46468944301152937, 0.9975080592218234, 0.8159754890213368, 1.012006233931577, 0.9418299273915791, 0.635]
Deleted dict_data. Memory Usage: 61.1
Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
sequence_inputs (InputLayer)    [(None, 2, 16, 1001) 0                                            
__________________________________________________________________________________________________
lambda_8 (Lambda)               (None, 2, 16, 1001,  0           sequence_inputs[0][0]            
__________________________________________________________________________________________________
pwms_init_lyr (Conv3D)          (None, 2, 4, 994, 8) 256         lambda_8[0][0]                   
__________________________________________________________________________________________________
rc_split (Lambda)               [(None, 1, 4, 994, 8 0           pwms_init_lyr[0][0]              
__________________________________________________________________________________________________
rc_neg (Lambda)                 (None, 1, 4, 994, 8) 0           rc_split[0][1]                   
__________________________________________________________________________________________________
rc_concat (Lambda)              (None, 2, 4, 994, 8) 0           rc_split[0][0]                   
                                                                 rc_neg[0][0]                     
__________________________________________________________________________________________________
maxpool_pwms (MaxPooling3D)     (None, 1, 4, 9, 8)   0           rc_concat[0][0]                  
__________________________________________________________________________________________________
permute_2 (Permute)             (None, 4, 9, 8, 1)   0           maxpool_pwms[0][0]               
__________________________________________________________________________________________________
avg_pwms (AveragePooling3D)     (None, 4, 1, 8, 1)   0           permute_2[0][0]                  
__________________________________________________________________________________________________
lambda_9 (Lambda)               (None, 4, 8)         0           avg_pwms[0][0]                   
__________________________________________________________________________________________________
transpose_2 (Permute)           (None, 8, 4)         0           lambda_9[0][0]                   
__________________________________________________________________________________________________
lambda_10 (Lambda)              (None, 8, 4, 1)      0           transpose_2[0][0]                
__________________________________________________________________________________________________
combine_pwms (Conv2D)           (None, 1, 4, 4)      36          lambda_10[0][0]                  
__________________________________________________________________________________________________
lambda_11 (Lambda)              (None, 4, 4)         0           combine_pwms[0][0]               
__________________________________________________________________________________________________
cell_inputs (InputLayer)        [(None, 4, 4)]       0                                            
__________________________________________________________________________________________________
mult_acc_pwms (Multiply)        (None, 4, 4)         0           lambda_11[0][0]                  
                                                                 cell_inputs[0][0]                
__________________________________________________________________________________________________
average_pooling1d_2 (AveragePoo (None, 1, 4)         0           mult_acc_pwms[0][0]              
__________________________________________________________________________________________________
flatten_4 (Flatten)             (None, 4)            0           average_pooling1d_2[0][0]        
__________________________________________________________________________________________________
cell_split (Lambda)             [(None, 1), (None, 1 0           flatten_4[0][0]                  
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][1]                 
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][2]                 
__________________________________________________________________________________________________
prediction_1 (Dense)            (None, 1)            3           concatenate_6[0][0]              
__________________________________________________________________________________________________
prediction_2 (Dense)            (None, 1)            3           concatenate_7[0][0]              
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 2)            0           cell_split[0][0]                 
                                                                 cell_split[0][3]                 
__________________________________________________________________________________________________
reshape_6 (Reshape)             (None, 1, 1)         0           prediction_1[0][0]               
__________________________________________________________________________________________________
reshape_7 (Reshape)             (None, 1, 1)         0           prediction_2[0][0]               
__________________________________________________________________________________________________
prediction_3 (Dense)            (None, 1)            3           concatenate_8[0][0]              
__________________________________________________________________________________________________
concat_cell_preds_1 (Lambda)    (None, 2, 1)         0           reshape_6[0][0]                  
                                                                 reshape_7[0][0]                  
__________________________________________________________________________________________________
reshape_8 (Reshape)             (None, 1, 1)         0           prediction_3[0][0]               
__________________________________________________________________________________________________
concat_cell_preds_2 (Lambda)    (None, 3, 1)         0           concat_cell_preds_1[0][0]        
                                                                 reshape_8[0][0]                  
__________________________________________________________________________________________________
flatten_5 (Flatten)             (None, 3)            0           concat_cell_preds_2[0][0]        
==================================================================================================
Total params: 301
Trainable params: 301
Non-trainable params: 0
__________________________________________________________________________________________________
None
['Random_Init', 'All', 0.8452829266191977, 0.9491061548898575, 0.7491061548898574, 0.8478317454663041, 0.6018099018895128, 0.19612921357253751, 0.5961292135725376, 0.46468944301152937, 0.9975080592218234, 0.8159754890213368, 1.012006233931577, 0.9418299273915791, 0.635]
